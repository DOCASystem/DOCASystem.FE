(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[436],{1266:function(e,t,n){Promise.resolve().then(n.bind(n,7657))},9376:function(e,t,n){"use strict";var i=n(5475);n.o(i,"useParams")&&n.d(t,{useParams:function(){return i.useParams}}),n.o(i,"usePathname")&&n.d(t,{usePathname:function(){return i.usePathname}}),n.o(i,"useRouter")&&n.d(t,{useRouter:function(){return i.useRouter}}),n.o(i,"useSearchParams")&&n.d(t,{useSearchParams:function(){return i.useSearchParams}})},1364:function(e,t,n){"use strict";var i=n(8619),r=n(7693);let a=new i.VK({basePath:r.q7,baseOptions:{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")||"")}}});t.Z=a},7657:function(e,t,n){"use strict";n.d(t,{default:function(){return x}});var i=n(7437),r=n(2265),a=n(9376),s=n(3544),l=n(9701),c=n(5665),o=n(8619),d=n(1364);let u=new o.Uc(d.Z),h={getBlogById:async e=>{try{return await u.apiV1BlogsIdGet(e)}catch(e){throw e}},updateBlog:async(e,t)=>{try{let n={name:t.title,description:t.description,status:t.status,isHidden:t.isHidden};return await u.apiV1BlogsIdPatch(e,n)}catch(e){throw e}}};var m=n(3145),g=n(9064),p=n(9884);function x(){let e=(0,a.useRouter)(),{id:t}=(0,a.useParams)(),n=(0,r.useRef)(null),[o,d]=(0,r.useState)(!0),[u,x]=(0,r.useState)(!1),[b,f]=(0,r.useState)(null),[v,y]=(0,r.useState)(null),[k,j]=(0,r.useState)({title:"",categoryIds:[],status:"",description:"",mainImage:null}),[N,w]=(0,r.useState)(null),[Z,I]=(0,r.useState)(!1),[P,_]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{if(t){d(!0);try{var e,n,i,r;let a=await h.getBlogById(t),s={id:t,title:(null==a?void 0:null===(e=a.data)||void 0===e?void 0:e.name)||"Blog demo",categoryIds:Array.isArray(null==a?void 0:null===(n=a.data)||void 0===n?void 0:n.blogCategories)?a.data.blogCategories.map(e=>{var t;return null!==(t=e.id)&&void 0!==t?t:""}).filter(Boolean).map(String):["news"],status:(null==a?void 0:null===(i=a.data)||void 0===i?void 0:i.status)||"PUBLISHED",description:(null==a?void 0:null===(r=a.data)||void 0===r?void 0:r.description)||"M\xf4 tả blog demo",mainImage:"/images/placeholder-blog.jpg"};y(s),j({title:s.title,categoryIds:s.categoryIds,status:s.status,description:s.description,mainImage:null}),s.mainImage&&w(s.mainImage)}catch(e){console.error("Error fetching blog:",e),f("Kh\xf4ng thể tải dữ liệu blog. Vui l\xf2ng thử lại sau.")}finally{d(!1)}}})()},[t]);let S=e=>{_(e),I(!0)},q=async()=>{if(t&&P){x(!0);try{let n=P.status;await h.updateBlog(t,{title:P.title,description:P.description,status:n,isHidden:!1}),g.ZP.success("Cập nhật blog th\xe0nh c\xf4ng!"),I(!1),setTimeout(()=>{e.push("/blog-management")},1e3)}catch(e){console.error("Error updating blog:",e),g.ZP.error("Cập nhật blog thất bại. Vui l\xf2ng thử lại sau.")}finally{x(!1)}}};return(0,i.jsxs)("div",{children:[b?(0,i.jsxs)("div",{className:"text-center py-10 text-red-500",children:[b,(0,i.jsx)("div",{className:"mt-4",children:(0,i.jsx)("button",{onClick:()=>e.push("/blog-management"),className:"px-4 py-2 bg-pink-doca text-white rounded-md hover:bg-pink-500",children:"Quay lại danh s\xe1ch"})})]}):(0,i.jsxs)(s.Z,{title:"Chỉnh sửa b\xe0i blog",schema:c.gT,defaultValues:k,onSubmit:e=>{S(e)},backLink:"/blog-management",submitButtonText:u?"Đang lưu...":"Cập nhật b\xe0i blog",maxHeight:"max-h-[calc(100vh-200px)]",formClassName:"h-[calc(100vh-150px)]",contentClassName:"pb-4 custom-scrollbar",children:[o&&(0,i.jsx)("div",{className:"absolute inset-0 bg-white bg-opacity-80 flex items-center justify-center z-10",children:(0,i.jsx)("div",{className:"text-lg font-medium text-pink-doca",children:"Đang tải dữ liệu blog..."})}),(0,i.jsx)("div",{className:"flex justify-end mb-4",children:(0,i.jsx)("button",{type:"button",onClick:()=>{e.push("/blog-management/view?id=".concat(t))},className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",children:"Xem b\xe0i viết"})}),(0,i.jsx)(l.Z,{name:"title",label:"Ti\xeau đề b\xe0i blog",placeholder:"Nhập ti\xeau đề b\xe0i blog"}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("p",{className:"text-base font-semibold mb-2",children:"Ph\xe2n loại"}),(0,i.jsxs)("select",{className:"w-full p-2 border border-gray-300 rounded-md",name:"categoryIds",defaultValue:(null==v?void 0:v.categoryIds[0])||"",children:[(0,i.jsx)("option",{value:"",children:"Chọn ph\xe2n loại"}),(0,i.jsx)("option",{value:"news",children:"Tin tức"}),(0,i.jsx)("option",{value:"tips",children:"Mẹo chăm s\xf3c th\xfa cưng"}),(0,i.jsx)("option",{value:"stories",children:"C\xe2u chuyện th\xfa cưng"}),(0,i.jsx)("option",{value:"adoption",children:"Nhận nu\xf4i"})]})]}),(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("p",{className:"text-base font-semibold mb-2",children:"Trạng th\xe1i"}),(0,i.jsxs)("select",{className:"w-full p-2 border border-gray-300 rounded-md",name:"status",defaultValue:(null==v?void 0:v.status)||"",children:[(0,i.jsx)("option",{value:"",children:"Chọn trạng th\xe1i"}),(0,i.jsx)("option",{value:"URGENT",children:"Khẩn cấp"}),(0,i.jsx)("option",{value:"NEED_PRODUCT",children:"Cần hỗ trợ"}),(0,i.jsx)("option",{value:"PUBLISHED",children:"Xuất bản"}),(0,i.jsx)("option",{value:"DRAFT",children:"Nh\xe1p"})]})]})]}),(0,i.jsx)(l.Z,{name:"description",label:"M\xf4 tả",placeholder:"Nhập m\xf4 tả b\xe0i blog",isTextArea:!0}),(0,i.jsxs)("div",{className:"mt-4",children:[(0,i.jsx)("p",{className:"text-base font-semibold mb-2",children:"H\xecnh ảnh"}),(0,i.jsxs)("div",{className:"border-2 border-dashed border-gray-300 p-6 rounded-lg text-center",children:[N?(0,i.jsx)("div",{className:"mb-4",children:(0,i.jsx)(m.default,{src:N,alt:"Preview",width:200,height:200,className:"mx-auto object-cover rounded"})}):(0,i.jsx)("p",{children:"K\xe9o v\xe0 thả ảnh hoặc nhấp để chọn ảnh"}),(0,i.jsx)("input",{type:"file",accept:"image/*",name:"mainImage",className:"hidden",id:"blog-image-edit",ref:n,onChange:e=>{var t;let n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!n)return;j(e=>({...e,mainImage:n}));let i=new FileReader;i.onload=()=>{w(i.result)},i.readAsDataURL(n)}}),(0,i.jsx)("label",{htmlFor:"blog-image-edit",className:"mt-2 inline-block px-4 py-2 bg-pink-doca text-white rounded-md cursor-pointer",children:N?"Đổi ảnh kh\xe1c":"Chọn ảnh"})]})]})]}),(0,i.jsx)(p.Z,{isOpen:Z,title:"X\xe1c nhận cập nhật b\xe0i viết",message:"Bạn c\xf3 chắc chắn muốn cập nhật b\xe0i viết n\xe0y với những thay đổi đ\xe3 nhập?",confirmButtonText:"Cập nhật",cancelButtonText:"Hủy",onConfirm:q,onCancel:()=>{I(!1),_(null)},type:"info"})]})}},9555:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var i=n(7437),r=n(1201);function a(e){let{className:t,children:n,onClick:a,disabled:s=!1,loading:l=!1,variant:c="primary",type:o="button"}=e;return(0,i.jsx)("button",{onClick:a,disabled:s||l,type:o,className:(0,r.cn)("w-[172px] h-[60px] text-[20px] text-center font-medium rounded-xl transition-all duration-200",{primary:"bg-pink-doca text-white hover:bg-pink-600",secondary:"bg-gray-500 text-white hover:bg-gray-600",outline:"border border-pink-doca text-pink-doca hover:bg-pink-doca hover:text-white"}[c],s&&"opacity-50 cursor-not-allowed",t),children:l?(0,i.jsx)("span",{className:"animate-spin",children:"⏳"}):n})}n(2265)},9884:function(e,t,n){"use strict";var i=n(7437);n(2265);var r=n(4887),a=n(1201);t.Z=e=>{let{isOpen:t,title:n,message:s,confirmButtonText:l,cancelButtonText:c,onConfirm:o,onCancel:d,confirmButtonClass:u,cancelButtonClass:h,type:m="info"}=e;if(!t)return null;let g={warning:{header:"bg-yellow-50 border-yellow-200",title:"text-yellow-700",confirmButton:"bg-yellow-500 hover:bg-yellow-600"},danger:{header:"bg-red-50 border-red-200",title:"text-red-700",confirmButton:"bg-red-500 hover:bg-red-600"},info:{header:"bg-blue-50 border-blue-200",title:"text-blue-700",confirmButton:"bg-blue-500 hover:bg-blue-600"}};return(0,r.createPortal)((0,i.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-md mx-4 overflow-hidden",children:[(0,i.jsx)("div",{className:(0,a.cn)("px-6 py-4 border-b",g[m].header),children:(0,i.jsx)("h3",{className:(0,a.cn)("text-lg font-medium",g[m].title),children:n})}),(0,i.jsx)("div",{className:"px-6 py-4",children:(0,i.jsx)("p",{className:"text-gray-700",children:s})}),(0,i.jsxs)("div",{className:"px-6 py-4 bg-gray-50 flex justify-end space-x-3",children:[(0,i.jsx)("button",{onClick:d,className:(0,a.cn)("px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors",h),children:c}),(0,i.jsx)("button",{onClick:o,className:(0,a.cn)("px-4 py-2 text-white rounded-md transition-colors",g[m].confirmButton,u),children:l})]})]})}),document.body)}},3544:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var i=n(7437),r=n(9501),a=n(3842),s=n(9555),l=n(9680),c=n(1201);function o(e){let{title:t,children:n,onSubmit:o,schema:d,defaultValues:u,backLink:h="",backButtonText:m="Quay lại",submitButtonText:g="Lưu",methods:p,className:x,formClassName:b,submitButtonClassName:f,contentClassName:v,maxHeight:y="max-h-[70vh]"}=e,k=(0,r.cI)({resolver:(0,a.X)(d),defaultValues:u}),j=p||k,N=j.handleSubmit(o);return(0,i.jsxs)("div",{className:(0,c.cn)("w-full",x),children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[t&&(0,i.jsx)("h1",{className:"text-2xl font-semibold text-pink-doca",children:t}),h&&(0,i.jsx)(s.Z,{className:"w-32 h-11 text-lg",children:(0,i.jsx)(l.Z,{href:h,children:m})})]}),(0,i.jsx)(r.RV,{...j,children:(0,i.jsxs)("form",{onSubmit:N,className:(0,c.cn)("bg-white p-6 rounded-lg shadow-md flex flex-col h-full",b),children:[(0,i.jsx)("div",{className:(0,c.cn)("flex-1 flex flex-col gap-4 overflow-y-auto pr-2 custom-scrollbar",y,v),children:n}),(0,i.jsx)("div",{className:"mt-6 flex justify-end sticky bottom-0 pt-4 bg-white border-t border-gray-100",children:(0,i.jsx)(s.Z,{type:"submit",className:(0,c.cn)("h-12 bg-pink-doca text-white text-base rounded-md px-6",f),children:g})})]})})]})}},9701:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var i=n(7437),r=n(9501),a=n(1201);function s(e){var t,n;let{name:s,label:l,type:c="text",placeholder:o,className:d,isTextArea:u=!1,autoComplete:h}=e,{register:m,formState:{errors:g}}=(0,r.Gc)();return(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,i.jsx)("label",{htmlFor:s,className:"text-base font-semibold",children:l}),u?(0,i.jsx)("textarea",{...m(s),id:s,placeholder:o,className:(0,a.cn)("px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500",d)}):(0,i.jsx)("input",{...m(s),id:s,type:c,placeholder:o,autoComplete:h,className:(0,a.cn)("px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500",d)}),g[s]&&(0,i.jsx)("p",{className:"text-red-500 text-sm",children:null===(n=g[s])||void 0===n?void 0:null===(t=n.message)||void 0===t?void 0:t.toString()})]})}},9680:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var i=n(7437),r=n(1201),a=n(7648);function s(e){let{href:t,className:n,children:s}=e;return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(a.default,{href:t,className:(0,r.cn)("",n),children:s})})}},7693:function(e,t,n){"use strict";n.d(t,{Pn:function(){return r},kG:function(){return a},q7:function(){return i}});let i="https://production.doca.love",r={AUTH:{LOGIN:"/api/v1/login",SIGNUP:"/api/v1/signup",FORGET_PASSWORD:"/api/v1/forget-password",OTP:"/api/v1/otp"}},a=e=>(r.AUTH.LOGIN,"".concat(i).concat(e))},1201:function(e,t,n){"use strict";n.d(t,{cn:function(){return a}});var i=n(1994),r=n(3335);function a(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.m6)((0,i.Z)(t))}},5665:function(e,t,n){"use strict";n.d(t,{Iy:function(){return d},Qx:function(){return c},dm:function(){return a},gM:function(){return l},gT:function(){return u},if:function(){return s},kn:function(){return r},ot:function(){return o}});var i=n(4422);let r=i.Ry().shape({firstName:i.Z_().matches(/^[A-Za-zÀ-ỹ\s]+$/,"Họ chỉ được chứa chữ v\xe0 dấu").required("Họ kh\xf4ng được để trống"),lastName:i.Z_().matches(/^[A-Za-zÀ-ỹ\s]+$/,"T\xean chỉ được chứa chữ v\xe0 dấu").required("T\xean kh\xf4ng được để trống"),email:i.Z_().email("Invalid email").required("Email kh\xf4ng được để trống"),password:i.Z_().min(6,"Mật khẩu \xedt nhất 6 k\xfd tự").matches(/[!@#$%^&*(),.?":{}|<>]/,"Mật khẩu cần c\xf3 \xedt nhất 1 k\xfd tự đặc biệt").required("Mật khẩu kh\xf4ng được để trống"),confirmPassword:i.Z_().oneOf([i.iH("password")],"Mật khẩu x\xe1c nhận kh\xf4ng khớp").required("X\xe1c nhận mật khẩu kh\xf4ng được để trống"),phone:i.Z_().matches(/^[0-9]{10}$/,"Số điện thoại phải c\xf3 10 chữ số").required("Số điện thoại kh\xf4ng được để trống"),otp:i.Z_().required("OTP kh\xf4ng được để trống"),message:i.Z_().optional()}),a=i.Ry().shape({email:i.Z_().required("Email hoặc số điện thoại kh\xf4ng được để trống"),password:i.Z_().required("Mật khẩu kh\xf4ng được để trống")});r.pick(["firstName","lastName"]);let s=r.pick(["firstName","lastName","email","password","confirmPassword","phone","otp"]),l=i.Ry().shape({email:i.Z_().email("Email kh\xf4ng hợp lệ").required("Email kh\xf4ng được để trống")}),c=i.Ry().shape({otp:i.Z_().required("OTP kh\xf4ng được để trống")}),o=i.Ry().shape({password:i.Z_().min(6,"Mật khẩu \xedt nhất 6 k\xfd tự").matches(/[!@#$%^&*(),.?":{}|<>]/,"Mật khẩu cần c\xf3 \xedt nhất 1 k\xfd tự đặc biệt").required("Mật khẩu kh\xf4ng được để trống"),confirmPassword:i.Z_().oneOf([i.iH("password")],"Mật khẩu x\xe1c nhận kh\xf4ng khớp").required("X\xe1c nhận mật khẩu kh\xf4ng được để trống")}),d=i.Ry().shape({name:i.Z_().required("T\xean sản phẩm kh\xf4ng được để trống"),price:i.Rx().positive("Gi\xe1 phải l\xe0 số dương").required("Gi\xe1 kh\xf4ng được để trống"),description:i.Z_().required("M\xf4 tả kh\xf4ng được để trống"),categoryIds:i.IX().min(1,"Phải chọn \xedt nhất 1 danh mục"),mainImage:i.nK().test("fileSize","File qu\xe1 lớn",e=>!e||e.size<=5e6),quantity:i.Rx().required("Số lượng kh\xf4ng được để trống"),size:i.Z_().required("K\xedch thước kh\xf4ng được để trống")}),u=i.Ry().shape({title:i.Z_().required("Ti\xeau đề kh\xf4ng được để trống"),content:i.Z_().required("Nội dung kh\xf4ng được để trống"),status:i.Z_().oneOf(["DRAFT","PUBLISHED","URGENT","NEED_PRODUCT","NEED_DONATION"],"Trạng th\xe1i kh\xf4ng hợp lệ"),categoryIds:i.IX().min(1,"Phải chọn \xedt nhất 1 danh mục"),description:i.Z_().required("M\xf4 tả kh\xf4ng được để trống")});i.Ry().shape({productId:i.Z_().required(),quantity:i.Rx().min(1,"Số lượng tối thiểu l\xe0 1").required("Số lượng kh\xf4ng được để trống")})}},function(e){e.O(0,[648,878,137,915,464,99,619,971,117,744],function(){return e(e.s=1266)}),_N_E=e.O()}]);